# Make cats free again (MCF)

## Словарь

* `happy cat box` - компания заказчик системы 
* `make cats free` - `MCF`, дочерняя компания happy cat box, целью которой станет уменьшение посторонней работы `котов-тестировщиков`
* `коты-тестировщики` - коты, которые занимаются тестированием "устройств для игры"; сотрудники `happy cat box` и клиенты системы `MCF`
* `коты-клиенты` - `клиенты`, см. `коты-тестировщики`
* `воркеры` - коты, которые выполняют поручения `котов-тестировщиков`, топ-3% талантов среди всех котов планеты
* `матчинг` - процесс подбора `воркеров` для поручений `клиентов`
* `кандидат` - кот, который хочет работать воркером в `MCF`
* `сборщик` - сотрудник отдела расходников
* `печеньковый подрядчик` - компания, доставляющая fur-tune-печенье для каждого заказа клиента

## Компоненты системы

### A. Личный кабинет клиента

* [UC.A-01] Клиент видит дашборд со списком всех заказанных им услуг.
* [UC.A-02] Клиент может запросить новую услугу нажав кнопку «запросить помощь» и заполнив форму с описанием, типом услуги и желаемой датой-временем выполнения.
* [UC.A-03] Клиент видит примерную стоимость услуги, когда заполняет форму запроса помощи.
* [UC.A-04] Клиент может поменять статус задачи.
* [UC.A-05] Клиент видит задачи, которые не были выполнены воркером (отменены).
* [UC.A-06] Клиент может создать новый заказ на любую отмененную задачу с возможностью выбора новой даты.
* [UC.A-07] Клиент должен указать способ оплаты задач.
* [UC.A-08] Клиент видит сумму, которую ему нужно будет оплатить в конце каждой недели.
* [UC.A-09] Клиент видит список инвойсов с итоговой суммой, статусами оплаты и списком задач, вошедших в каждый инвойс.
* [UC.A-10] Клиент видит значение величины своей текущей скидки.

### B. Приложение для воркеров

* [UC.B-01] Воркер видит список активных для него задач, а также список завершённых и отменённых услуг.
* [UC.B-02] Воркер видит сколько он заработал и сколько штрафов получил в текущем месяце.
* [UC.B-02] Воркер видит список инвойсов с итоговой суммой, статусами оплаты и списком задач, вошедших в каждый инвойс.

### C. Личный кабинет менеджера

#### CA. Управление услугами

* [UC.CA-01] Менеджер управляет списком типов услуг, которые `воркеры` оказывают `клиентам`.
* [UC.CA-02] Менеджер может задать константное значение стоимости оказания услуги.

#### CB. Управление наймом

* [UC.CB-01] Менеджер управляет набором тестов для проверки `кандидатов` в `воркеры`.
* [UC.CB-02] Менеджер управляет списком вакансий `воркеров` и набором тестов для каждой вакансии.
* [UC.CB-03] Менеджер видит список заявок от `кандидатов`.
* [UC.CB-04] Менеджер управляет набором тестов для каждого отдельного `кандидата`.
* [UC.CB-05] Менеджер может одобрить `кандидата` по итогам прохождения тестирования.
* [UC.CB-06] Менеджер может отбраковать `кандидата` по итогам прохождения тестирования.
* [UC.CB-07] Менеджер заполняет характеристику на `кандидата` при одобрении заявки.

#### CC. Управление воркерами

* [UC.CC-01] Менеджер видит список `воркеров`.
* [UC.CC-02] Менеджер может зачислить любое количество денег для выбранного `воркера` на своё усмотрение.

#### CD. Контроль качества работы воркеров

* [UC.CD-01] Менеджер видит список выполненных заказов.
* [UC.CD-02] Менеджер может выбрать любой выполненный заказ и проверить качество выполненной работы.
* [UC.CD-03] Менеджер видит список отмененных и проваленных заказов изучения качества.
* [UC.CD-04] Менеджер заносит результаты проверки качества в отдельную форму.

#### CE. Мотивация менеджеров
* [UC.CE-01] Менеджер может сделать ставку на любой заказ до момента выполнения или отмены. Для этого он заполняет сумму и условие "выполнен" / "провален".
* [UC.CE-02] При выполнении или провале, система определяет какие ставки выиграли и делит сумму всех ставок на количество выигравших.
* [UC.CE-03] При выполнении или провале, система определяет какие ставки выиграли и делит сумму всех ставок на количество выигравших.
* [UC.CE-04] Менеджер видит, сколько он выиграл или сколько должен скинуть выигравшим.

### D. Сбор расходников

* [UC.D-01] Сборщик видит список заказов, для которых нужно собрать расходники.
* [UC.D-02] Сборщик видит в заказе данные из задачи клиента: тип, описание и желаемую дату-время исполнения.
* [UC.D-03] Сборщик может отметить заказ как выданный.
* [UC.D-04] Печеньковый подрядчик получает информацию о клиенте для изготовления и доставки печенья.

### E. Сайт для устройства в штат MCF

* [UC.E-01] Кандидат видит список открытых вакансий.
* [UC.E-02] Кандидат может оставить заявку на сайте.

### F. Билинг и учет

#### FA. Списания

* [UC.FA-01] Система регистрирует будущее списание со счета клиента после успешного матчинга клиента и воркера.
* [UC.FA-02] Система расчитывает размер персональной скидки клиенту по сумме всех предыдущих оплат.
* [UC.FA-03] Система расчитывает стоимость по секретной формуле, которую пока никто не знает, поэтому для первой версии хватит задать константное значение в 100 условных кото-единиц за любую услугу. Расчет происходит с учетом персональной скидки.
* [UC.FA-04] Каждое воскресенье система создает для клиента инвойс на оплату из списаний за неделю.
* [UC.FA-05] Система списывает сумму по инвойсу через указанный клиентом в личном кабинете способ. 
* [UC.FA-06] При успешном списании средств, система помечает инвойс и списания как оплаченные.

#### FB. Начисления

* [UC.FB-01] Система регистрирует будущее начисление воркеру после успешного выполнения заказа.
* [UC.FB-02] Система расчитывает размер начисления воркеру как 60% от стоимости услуги.
* [UC.FB-03] Система начисляет воркеру штраф в размере 40 условных кото-единиц при провале задачи.
* [UC.FB-04] Каждый последний день месяца система создает для воркера инвойс для начисления вознаграждения за оказанные услуги.
* [UC.FB-05] Система расчитывает сумму итогового начисления воркеру равную общим выплатам минус все штрафы за текущий месяц.
* [UC.FB-06] Система зачисляет средства воркеру через золотую шляпу (уникальный сервис для перевода денег, никак не связанный с «золотой короной»).
* [UC.FB-07] При успешном зачислении, система помечает инвойс и начисления как выполненные.

## Нагрузка

* 10 заказов в день
* 100 клиентов
* 20 вркеров
* 15 менеджеров
* 1000 заявок в день от котов, желающих стать воркерами 

## Схема взаимодействия компонентов

![](./attachments/step-0-components.jpg)

### Обоснование

Решение об использовани монолитной архитектуры с небольшой обзявкой из сервисов принято для ускорения разработки на первых этапах за счет исключения накладных расходов на инфраструктуру, мониторинг и трейсинг. 

Так же обозначенная заказчиком нагрузка выглядит незначительной и на первых этапах не требует возможности горизонтального масштабирования системы.  

Чтобы облегчить возможный распил монолита в будущем, в системе планируется добиться слабой связанности кодовой базы и данных.

Весь функционал, связанный с финансами, выделен в отдельный сервис, чтобы упростить обеспечение безопасности данных и обособить взаимодействие с эквайрингом и платежным шлюзом.

Система мотивации выделена в отдельный сервис, чтобы  выключить ее, если что... И не было никогда никакой системы мотивации.

## Вопросы и спорные места.

* Что значит "все коты-тестировщики (клиенты) автоматически попадают в систему". Автоматически - это как? Нет требований к флоу регистрации, аутентификации, авторизации.
* У сборщиков расходников есть кнопка, чтобы отметить расходники выданными, но нет кнопки, чтобы отметить заказ собранным.
* Сотрудники отдела изучения качества работы и "менеджеры" - это одни и те же люди?
* Никак не описан формат взаимодействия с внешним подрядчиком. Видимо, надо будет выяснить в процессе.
